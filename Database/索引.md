# 索引



## 索引是什么

索引是一种能加快数据库查询速率的存储结构，类似于图书目录，是一种空间换时间的数据查询解决方案，适当的索引可以加快数据的读取速度，但每个索引会减缓写的速度。



## 索引有哪些

​		*段存储是一种数据存储磁盘的方式，段是一种逻辑结构，底层时通过MMU对物理磁盘地址的一种映射，由一或多个页组成，由于段式存储是追加数据，所以磁盘地址一般是连续的，这对磁盘的读写有很大的帮助。*



​	K-V，表示需要通过唯一主键通过key-value形式进行数据关联。



- 哈希索引【K-V】

  - 在内存中以KV的形式保存磁盘中每个数据最新的偏移量，数据以追加的形式加入每个数据段中，当段过大时，进行段合并，去除重复的过期的数据。数据库示例：Bitcask

  - 读写高效
  - 不利于存储大量的键
  - 区间查询效率低

- LSM-Tree【K-V】

  - 基于合并-压缩排序文件的存储引擎通常成为LSM存储1引擎
  - 在磁盘中
    - 对于每一个数据在同一个段中需要保证不重复切有序的约束，
    - 定期重写段，消除数据碎片化问题

  - 在内存中

    - 内存索引指向段开头，**不再需要存储所有的索引键**，可以通过区间查找数据落在哪一块段中。合并过程可以通过归并排序进行数据合并。

    - 内存索引指向压缩段，可以对段内的数据进行压缩，即在段中某个位置加上内存索引
    - 内存中存储一张内存表，数据结构为红黑树。

  - 支持区间查询

  - 数据库： LevelDB、RocksDB、Cassaandra、HBase

- 全文索引【与LSM-Tree类似】

  - 对存储内容词法拆分，并为每一个词作为索引中的键，值是包含该单词的文档ID的列表（倒排表）。

- B-Tree 索引

  - 以页作为内部存储的基本单元，有碎片化问题
  - 随机写入磁盘
  - 每个页面都能被地址(磁盘地址)引用
  - 通过非叶子节点的磁盘引用地址查找，最终找到每个键对应的磁盘数据地址
  - 优化：为叶子页面向左向右关联兄弟节点。
  - 相对LSM 写入慢，读取快
  - 在原有数据页上修改数据，而不是追加数据，需要事务进行辅助
  - 数据库：Mysql

- 聚集索引与非聚集索引

- 多列索引
